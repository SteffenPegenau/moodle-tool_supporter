index_page: Einbinden von user_table Ã¼ber js
<div data-region = "user_table">
</div>

 {{#js}}
  require(['tool_supporter/user_table_load'], function(load){
    load.load();
  });
 {{/js}}

Abrufen von Kursen in einer Kategorie und darunter - Filter nach Semester oder Fachbereich
(https://docs.moodle.org/22/en/ad-hoc_contributed_reports)

List all Courses in and below a certain category
Use this SQL code to retrieve all courses that exist in or under a set category.

$s should be the id of the category you want to know about...

SELECT prefix_course. * , prefix_course_categories. *
FROM prefix_course, prefix_course_categories
WHERE prefix_course.category = prefix_course_categories.id
AND (
prefix_course_categories.path LIKE '/$s/%'
OR prefix_course_categories.path LIKE '/$s'
)

Datenbank abfrage courses, kumulierte Tabelle: Felder: id, name, visible, parent category, category
SELECT c.id, c.shortname, c.visible, cat.name AS fb, (SELECT name FROM mdl_course_categories WHERE id = cat.parent) AS semester FROM `mdl_course` c, mdl_course_categories cat WHERE c.category = cat.id


Course_table.php: Erster Versuch Dtenbankabfrage, kleinteilig, ohne webservice
global $DB;
$rs = $DB->get_recordset('course', null, null, 'id, fullname, shortname, category'); //Load ALL courses in $rs (object), fields: id, fullname, shortname, category
//  $categories = $DB->get_recordset('course_categories', null, null, 'id, name, path'); //Load ALL course categories, fields id, name, path (path includes parents, grandparents etc id)
foreach ($rs as $record) { //single course as array in array $courses, so it can be rendered
  $cat_id = $record->category;
  $record = (array)$record;
  $record['parent_category'] = null;
  if($cat_id != 0){
    $path = $DB->get_record_sql('Select path FROM {course_categories} WHERE id = ?', array($cat_id));
    //$path = $DB->get_record('course_categories', array('id' => $cat_id), 'path');
    $record['category'] = $this->get_category((string)$path->path, -1);
    $record['parent_category'] =$this->get_category((string)$path->path, 1);
  }
  $courses[] = $record;
}
$rs->close();
//  $categories->close();
$data['courses'] = $courses;
