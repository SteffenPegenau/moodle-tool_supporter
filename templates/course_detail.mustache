{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!

  Documentation gets here!
  --- wird unter der Template-Library gespeichert unter admin/tool/templatelibrary

    @template tool_supporter/course_detail

    Starting point for an awesome template.

}}
<!--View details after clicking on a course in course table.  -->
<div style="display: none" data-region = "course_details" class="well well-sm">
  <div class="navbar">
    <div class="navbar-inner">
      {{#courseDetails}}
        <a class="brand" href="#">{{fullname}}</a>
      {{/courseDetails}}
      <ul class="nav">
        {{#links}}
          <li><p class="navbar-btn"><a href="{{deletelink}}" target="_blank" class="btn btn-default" id="hide_user">{{#str}}deletecourse{{/str}}</a></p></li>
          <li><p class="navbar-btn"><a href="{{settingslink}}" target="_blank" class="btn btn-default" id="hide_user">{{#str}}editsettings{{/str}}</a></p></li>
        {{/links}}
        <li><p class="navbar-btn"><a href="#" class="btn btn-default" id="hide_course_details">{{#str}}hide{{/str}}</a></p></li>
      </ul>
    </div>
  </div>
<!--Show course details  -->
<div class="table-responsive">
    <table class = "table borderless table-striped">
      <tbody>
        {{#courseDetails}}
        <tr>
          <th>ID</th>
          <td id="selectedcourseid">{{id}}</td>
        </tr>
        <tr>
          <th>{{#str}}shortname_course{{/str}}</th>
          <td>{{shortname}}</td>
        </tr>
        <tr>
          <th>{{#str}}longname_course{{/str}}</th>
          <td>{{fullname}}</td>
        </tr>
        <tr>
          <th>{{#str}}visible{{/str}}</th>
          <td>{{visible}}</td>
        </tr>
        <tr>
          <th>{{#str}}path_course{{/str}}</th>
          <td>{{pfad}}</td>
        </tr>
        <tr>
          <th>{{#str}}enrolledUsers{{/str}}</th>
          <td>{{enrolledUsers}}</td> <!--Number of enrolled users-->
        </tr>
        {{/courseDetails}}
        {{#roles}}
        <tr>
          <th>{{roleName}}</th>
          <td>{{roleNumber}}</td> <!--Number of users with role=roleName -->
        </tr>
        {{/roles}}
      </tbody>
    </table>
  </div>



	  <ul class="nav nav-tabs nav-justified" id = "myTabs" role="tablist">
	    <li class="nav-item"><a class = "nav-link" data-toggle="tab" href="#CoursePill_1" role = "tab">Eingeschriebene Nutzer_innen</a></li>
	    <li class = "nav-item"><a class = "nav-link" data-toggle="tab" href="#CoursePill_2" role = "tab">Aktivit√§ten</a></li>
	    <li class ="navbar-search pull-right">
	      <input id="{{uniqid}}-courseDetailSearch" type="text" class="search-query" placeholder="Search"> <!--Search field for searching in tables below-->
	    </li>
	 </ul>


 <div class="tab-content">
    <div id="CoursePill_1" class="tab-pane fade" role="tabpanel">
      <!--table of users in this course-->
      <div>
        <table class = "datatable table table-striped" id = "{{uniqid}}-userInCourse">
          <thead>
            <tr>
              <th>ID</th>
              <th>{{#str}}username{{/str}}</th>
              <th>{{#str}}firstname{{/str}}</th>
              <th>{{#str}}lastname{{/str}}</th>
              <th>{{#str}}roles{{/str}}</th>
            </tr>
          </thead>
          <tbody>
            {{#users}}
            <tr>
              <td>{{id}}</td>
              <td>{{username}}</td>
              <td>{{firstname}}</td>
              <td>{{lastname}}</td>
              <td>{{role}}</td>
              <td></td>
            </tr>
            {{/users}}
          </tbody>
        </table>
      </div>
    </div>
    <div id="CoursePill_2" class="tab-pane fade" role="tabpanel">
      <!--table of activites in this course-->
      <div>
        <table class = "datatable table table-striped" id = "{{uniqid}}-activityInCourse" >
          <thead>
            <tr>
              <th>{{#str}}sectionname{{/str}}</th>
              <th>{{#str}}activity{{/str}}</th>
              <th>{{#str}}name{{/str}}</th>
              <th>{{#str}}visible{{/str}}</th>
            </tr>
          </thead>
          <tbody>
            {{#activities}}
            <tr>
              <td>{{section}}</td>
              <td>{{activity}}</td>
              <td>{{name}}</td>
              <td>{{visible}}</td>
            </tr>
            {{/activities}}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

{{#js}}
require(['jquery','tool_supporter/table_search', 'tool_supporter/table_sort', 'tool_supporter/datatables', 'tool_supporter/load_information'],
      function($,search, sort, dataTable, click_on_user) {
  //selecting the active table by using click-Event
  $('#myTabs a').click(function(e){
    var activeTab = e.target.getAttribute('href');
    if(activeTab == "#CoursePill_1"){
      tabTableID = "#{{uniqid}}-userInCourse";
      click_on_user.click_on_user('#{{uniqid}}-userInCourse' + ' tbody'); //Load information about the clicked user
    }
    else if(activeTab == "#CoursePill_2"){
      tabTableID = "#{{uniqid}}-activityInCourse";
    };
    search.searchEvent('#{{uniqid}}-courseDetailSearch', tabTableID + " tbody");
  //  sort.sortTable(tabTableID); //Slow version to sort tables by headers
  //  dataTable.use_dataTable_tab(tabTableID); //Convert table to DataTable
  });

});

require(['tool_supporter/load_information'], function(hide_course_detail){
  hide_course_detail.hide_course_detail();
});

{{/js}}
