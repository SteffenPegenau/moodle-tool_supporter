define(["jquery","core/ajax","core/templates","core/notification"],function(a,b,c,d){var e=function(e){var f=b.call([{methodname:"tool_supporter_get_assignable_roles",args:{courseID:e}}]);f[0].done(function(b){console.log("assignableRoles Returns: "),console.log(b),c.render("tool_supporter/enrolusersection",b).done(function(b,d){a('[data-region="enroluserregion"]').replaceWith(b),a('[data-region="enroluserregion"]').show(),c.runTemplateJS(d)}).fail(d.exception)}).fail(d.exception)},f=function(a){h.show_course_detail(a)},g=function(){var e=b.call([{methodname:"tool_supporter_toggle_course_visibility",args:{courseID:a("#selectedcourseid")[0].textContent}}]);e[0].done(function(b){console.log("toggle visibility return data"),console.log(b.courseDetails.visible),c.render("tool_supporter/course_detail",b).done(function(b,d){a('[data-region="course_details"]').replaceWith(b),a('[data-region="course_details"]').show(),c.runTemplateJS(d)}).fail(d.exception)}).fail(d.exception)},h={show_course_detail:function(f,g){"undefined"===g&&(g=0);var h=a("#course_details").offset().top;a("html, body").animate({scrollTop:h-50},"slow");var i=b.call([{methodname:"tool_supporter_get_course_info",args:{courseID:f}}]);if(i[0].done(function(b){console.log("Show course detail Returns: "),console.log(b),c.render("tool_supporter/course_detail",b).done(function(b,d){a('[data-region="course_details"]').replaceWith(b),a('[data-region="course_details"]').show(),c.runTemplateJS(d),1===a("#selecteduserid").length&&e(f)}).fail(d.exception)}).fail(d.exception),g)return i},toggle_course_visibility:function(){a("#hide_course_visibility").on("click",function(){g()}),a("#show_course_visibility").on("click",function(){g()})},hide_user_details:function(){a("#btn_hide_user_details").on("click",function(){a("#user_details_body").hide(),a("#btn_hide_user_details").hide(),a("#btn_expand_user_details").show()})},expand_user_details:function(){a("#btn_expand_user_details").on("click",function(){a("#user_details_body").show(),a("#btn_hide_user_details").show(),a("#btn_expand_user_details").hide()})},hide_course_detail:function(){a("#btn_hide_course_details").on("click",function(){a("#course_details_body").hide(),a("#btn_hide_course_details").hide(),a("#btn_expand_course_details").show()})},expand_course_detail:function(){a("#btn_expand_course_details").on("click",function(){a("#course_details_body").show(),a("#btn_hide_course_details").show(),a("#btn_expand_course_details").hide()})},click_on_user:function(f){a(f+" tbody").on("click","tr",function(){var f=a(this).find("td:first-child").text(),g=a("#user_details").offset().top;a("html, body").animate({scrollTop:g-50},"slow");var h=b.call([{methodname:"tool_supporter_get_user_information",args:{userid:f}}]);h[0].done(function(b){console.log("click on user Returns: "),console.log(b),b=b[0],c.render("tool_supporter/user_detail",b).done(function(b,d){if(a('[data-region="user_details"]').replaceWith(b),a('[data-region="user_details"]').show(),a('[data-region="course_details"]').is(":visible")){var f=a("#selectedcourseid")[0].textContent;e(f)}c.runTemplateJS(d)}).fail(d.exception)}).fail(d.exception)})},click_on_course:function(b){a(b+" tbody").on("click","tr",function(){var b=a(this).find("td:first-child").text();f(b)})},click_on_refresh:function(e,f,g){a("#btn_refresh_users").on("click",function(){var e=b.call([{methodname:f,args:g}]);e[0].done(function(b){console.log("return data for refreshing a user"),console.log(b),c.render("tool_supporter/user_table",b).done(function(b,d){a('[data-region="user_table"]').replaceWith(b),c.runTemplateJS(d)}).fail(d.exception)}).fail(d.exception)}),a("#btn_refresh_courses").on("click",function(){var e=b.call([{methodname:f,args:g}]);e[0].done(function(b){console.log("return data for refreshing a course"),console.log(b),c.render("tool_supporter/course_table",b).done(function(b,d){a('[data-region="course_table"]').replaceWith(b),c.runTemplateJS(d)}).fail(d.exception)}).fail(d.exception)})},search:function(b,c,d,e){var f=0;e.forEach(function(b){a(c).append(a("<option>",{value:f,text:b.name})),f++}),a(d).on("keyup",function(){var e=a(b).dataTable(),f=a(d)[0].value,g=a(c)[0].value;"-1"==g?e.fnFilter(f,null,!0,!1,!1,!0):e.fnFilter(f,g,!0,!1,!1,!0)})}};return h});